jQuery(function(a){if("undefined"===typeof wc_price_based_country_frontend_params)return!1;var h={supports_html5_storage:!0,set_cart_creation_timestamp:function(){this.supports_html5_storage&&sessionStorage.setItem("wc_cart_created",(new Date).getTime())},set_cart_hash:function(a){this.supports_html5_storage&&(localStorage.setItem(wc_cart_fragments_params.cart_hash_key,a),sessionStorage.setItem(wc_cart_fragments_params.cart_hash_key,a))},refresh_cart:function(){a.ajax({url:wc_price_based_country_frontend_params.wc_ajax_url.toString().replace("%%endpoint%%",
"get_refreshed_fragments"),type:"POST",success:function(b){b&&b.fragments&&(a.each(b.fragments,function(b,c){a(b).replaceWith(c)}),h.supports_html5_storage&&(sessionStorage.setItem(wc_cart_fragments_params.fragment_name,JSON.stringify(b.fragments)),h.set_cart_hash(b.cart_hash),b.cart_hash&&h.set_cart_creation_timestamp()))}})},set_refresh_cart_flag:function(){"undefined"===typeof Cookies?a.cookie("wc_pbc_refresh_cart","1"):Cookies.set("wc_pbc_refresh_cart","1")},get_refresh_cart_flag:function(){return"undefined"===
typeof Cookies?a.cookie("wc_pbc_refresh_cart"):Cookies.get("wc_pbc_refresh_cart")},remove_refresh_cart_flag:function(){"undefined"===typeof Cookies?a.removeCookie("wc_pbc_refresh_cart"):Cookies.remove("wc_pbc_refresh_cart")},maybe_refresh_cart:function(){"undefined"!==typeof this.get_refresh_cart_flag()&&(this.remove_refresh_cart_flag(),this.refresh_cart())},init:function(){if("undefined"===typeof wc_cart_fragments_params)return!1;try{this.supports_html5_storage="sessionStorage"in window&&null!==
window.sessionStorage,window.sessionStorage.setItem("wcpbc","test"),window.sessionStorage.removeItem("wcpbc"),window.localStorage.setItem("wcpbc","test"),window.localStorage.removeItem("wcpbc")}catch(b){this.supports_html5_storage=!1}this.maybe_refresh_cart();a("form[class ^= wcpbc-widget]").on("submit",function(b){0<a("form.woocommerce-checkout").length||h.set_refresh_cart_flag()});a(document.body).on("updated_checkout",function(a,e){h.refresh_cart()})}};h.init();var g={xhr:!1,get_product_ids:function(){var b=
[];a("span.wcpbc-price.loading").each(function(e,c){var d=a(c).data("product-id");if("undefined"==typeof d){var f=a(c).attr("class").match(/wcpbc-price-\d+/);"undefined"!=typeof f&&0<f.length&&(d=f[0].replace("wcpbc-price-",""))}b.push(d)});a.each(a("form.variations_form").data("product_variations"),function(a,c){"undefined"!==typeof c.variation_id&&b.push(c.variation_id)});a(document.body).trigger("wc_price_based_country_get_product_ids",[b]);return b},get_areas:function(){var b={};a(".wc-price-based-country-refresh-area").each(function(e,
c){var d=a(c).data("area"),f=a(c).data("id"),g=a(c).data("options");"undefined"!==typeof d&&"undefined"!==typeof f&&"undefined"!==typeof g&&("undefined"==typeof b[d]&&(b[d]={}),b[d][f]=g)});return b},refresh_product_price:function(b){a.each(b,function(b,d){a(".wcpbc-price.wcpbc-price-"+d.id).html(a(d.price_html).html()).css("visibility","");a(".wcpbc-price.wcpbc-price-"+d.id).html(a(d.price_html).html()).removeClass("loading")});var e=a("form.variations_form").data("product_variations");"undefined"!==
typeof e&&(a.each(e,function(c,d){var f=a(d.price_html);"undefined"!==typeof b[d.variation_id]&&(e[c].display_price=b[d.variation_id].display_price,e[c].display_regular_price=b[d.variation_id].display_regular_price,f.hasClass("price")?f.first().html(b[d.variation_id].price_html):f.html(b[d.variation_id].price_html));f.find(".wcpbc-price").css("visibility","");f.find(".wcpbc-price").removeClass("loading");e[c].price_html=f.html()}),a("form.variations_form").data("product_variations",e));a(document.body).trigger("wc_price_based_country_set_product_price",
[b]);a(".wcpbc-price").css("visibility","");a(".wcpbc-price").removeClass("loading")},refresh_areas:function(b){a.each(b,function(b,c){var d='.wc-price-based-country-refresh-area[data-id="'+c.id+'"][data-area="'+c.area+'"]',e=a(c.content).filter('.wc-price-based-country-refresh-area[data-area="'+c.area+'"]').html();a(d).html(e)})},geolocate_customer:function(){g.xhr&&g.xhr.abort();var b={country:wc_price_based_country_frontend_params.country,ids:g.get_product_ids(),areas:g.get_areas()};g.xhr=a.ajax({url:wc_price_based_country_frontend_params.wc_ajax_url.toString().replace("%%endpoint%%",
"wcpbc_get_location"),data:b,type:"POST",success:function(a){g.refresh_product_price(a.products);g.refresh_areas(a.areas)},complete:function(){g.xhr=!1}})},init:function(){"1"===wc_price_based_country_frontend_params.ajax_geolocation&&(this.geolocate_customer(),a(document).ajaxComplete(function(b,e,c){if(0==a("body").find(".wcpbc-price.loading").length||0<c.url.indexOf("wcpbc_get_location")||0<c.url.indexOf("get_refreshed_fragments"))return!1;"undefined"!==typeof e.responseText&&0<e.responseText.indexOf("wcpbc-price")&&
g.geolocate_customer()}))}};g.init()});